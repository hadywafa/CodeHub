# **ðŸš€ PowerShell Profile Scripts - A Complete Guide**

A **PowerShell Profile Script** is a special script that runs automatically **whenever you open PowerShell**. It allows you to **customize your PowerShell environment**, **preload functions, aliases, and variables**, and **automate startup configurations**.

---

## **ðŸ“Œ 1. What is a PowerShell Profile Script?**

A **profile script** is a **PowerShell script (`.ps1` file)** that runs automatically when a new PowerShell session starts. It is used to **customize** the PowerShell environment with:

âœ… Custom **aliases**  
âœ… Preloaded **functions**  
âœ… Default **environment variables**  
âœ… Custom **prompt styles**  
âœ… Preloaded **modules**

---

## **ðŸ“Œ 2. Types of PowerShell Profiles**

PowerShell has **four profile scripts** based on scope:

| **Profile**                  | **Applies To**                                  | **Path**                                                      |
| ---------------------------- | ----------------------------------------------- | ------------------------------------------------------------- |
| **Current User, PowerShell** | Only for the current user in PowerShell         | `$HOME\Documents\PowerShell\Profile.ps1`                      |
| **Current User, All Hosts**  | Applies to all PowerShell versions for the user | `$HOME\Documents\PowerShell\Microsoft.PowerShell_profile.ps1` |
| **All Users, PowerShell**    | Applies to all users for PowerShell             | `$PSHOME\Profile.ps1`                                         |
| **All Users, All Hosts**     | Applies to all users for all PowerShell hosts   | `$PSHOME\Microsoft.PowerShell_profile.ps1`                    |

ðŸ”¹ **Most commonly used:**

- `$PROFILE` â†’ **Current User, Current Host**
- `$PROFILE.AllUsersAllHosts` â†’ **All Users, All Hosts**

### **ðŸ”¹ Check If a Profile Exists**

```powershell
Test-Path $PROFILE
```

âœ… Returns **`True`** if the profile exists, otherwise **`False`**.

---

## **ðŸ“Œ 3. Creating a PowerShell Profile Script**

### **ðŸ”¹ Create a Profile If It Doesnâ€™t Exist**

```powershell
if (!(Test-Path $PROFILE)) {
    New-Item -Path $PROFILE -ItemType File -Force
}
```

âœ… Creates a profile **if it doesnâ€™t exist**.

---

## **ðŸ“Œ 4. Editing Your PowerShell Profile**

### **ðŸ”¹ Open Profile for Editing**

```powershell
notepad $PROFILE
```

âœ… Opens the profile script **in Notepad**.

---

## **ðŸ“Œ 5. Customizing Your Profile**

### **ðŸ”¹ Adding Custom Aliases**

Aliases **shorten long commands**.

```powershell
Set-Alias ll Get-ChildItem
Set-Alias np notepad.exe
```

âœ… Now typing `ll` runs `Get-ChildItem`.

---

### **ðŸ”¹ Adding Custom Functions**

Functions **automate repetitive tasks**.

```powershell
function Greet-User {
    param ([string]$Name)
    Write-Output "Hello, $Name! Welcome to PowerShell."
}

Greet-User "Admin"
```

âœ… Every time PowerShell starts, **Greet-User is available**.

---

### **ðŸ”¹ Changing the PowerShell Prompt**

Modify how the **PowerShell prompt** looks.

```powershell
function prompt {
    Write-Host "[PowerShell] " -ForegroundColor Green -NoNewline
    return "> "
}
```

âœ… Changes the prompt to **`[PowerShell] >`**.

---

### **ðŸ”¹ Loading Custom Modules Automatically**

Load **useful modules** at startup.

```powershell
Import-Module PSReadLine
Import-Module Az
```

âœ… Preloads **Azure PowerShell** and **PSReadLine**.

---

### **ðŸ”¹ Setting Environment Variables**

Define **default paths** and **variables**.

```powershell
$env:LOGS_PATH = "C:\Logs"
$env:EDITOR = "notepad.exe"
```

âœ… Now `$env:LOGS_PATH` holds `"C:\Logs"`.

---

## **ðŸ“Œ 6. Running Your Profile Script**

To apply changes **without restarting PowerShell**, run:

```powershell
. $PROFILE
```

âœ… Loads the profile **immediately**.

---

## **ðŸ“Œ 7. Enabling Profile Execution (If Blocked)**

By default, PowerShell may **block profile scripts** for security reasons.

### **ðŸ”¹ Check Execution Policy**

```powershell
Get-ExecutionPolicy
```

### **ðŸ”¹ Allow Profile Execution**

```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

âœ… Enables **local scripts**, but requires signed remote scripts.

---

## **ðŸ“Œ 8. Deleting or Resetting a Profile**

To **delete your profile**:

```powershell
Remove-Item $PROFILE -Force
```

âœ… **Removes your profile**, restoring default PowerShell behavior.

---

## **ðŸ“Œ 9. Best Practices for PowerShell Profiles**

âœ… **Use Descriptive Aliases** â†’ Avoid conflicts with existing cmdlets.  
âœ… **Keep Profiles Modular** â†’ Store functions in separate scripts and import them.  
âœ… **Enable Logging** â†’ Add logs for troubleshooting startup issues.  
âœ… **Backup Your Profile** â†’ Keep a copy of your profile before making changes.

---

## **ðŸŽ¯ Conclusion: Mastering PowerShell Profiles**

âœ… PowerShell **profile scripts** automate environment setup.  
âœ… Use `$PROFILE` to manage **your user profile settings**.  
âœ… Customize **aliases, functions, and modules** for automation.  
âœ… **Load and apply** your profile with `. $PROFILE`.  
âœ… **Enable script execution** if blocked.
