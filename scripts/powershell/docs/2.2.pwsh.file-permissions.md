# **ðŸš€ Managing File Permissions in PowerShell - A Complete Guide**

PowerShell provides built-in tools for managing **file and directory permissions** using **Access Control Lists (ACLs)**. This guide will help you understand **how to get, modify, grant, revoke, and remove permissions** effectively.

---

## **ðŸ“Œ 1. Understanding File Permissions in PowerShell**

Windows uses **Access Control Lists (ACLs)** to manage permissions on files and folders. Each file or folder has a **Discretionary Access Control List (DACL)**, which defines who can access it and what actions they can perform.

### **ðŸ”¹ Common Permission Types**

| **Permission Type** | **Description**                                                         |
| ------------------- | ----------------------------------------------------------------------- |
| `FullControl`       | Grants complete control (read, write, delete, modify permissions)       |
| `Modify`            | Allows reading, writing, and deleting but **not** modifying permissions |
| `ReadAndExecute`    | Allows reading and running executable files                             |
| `Write`             | Allows writing to the file or folder                                    |
| `Read`              | Allows reading the file but not modifying it                            |

---

## **ðŸ“Œ 2. Viewing File and Folder Permissions (`Get-Acl`)**

PowerShellâ€™s `Get-Acl` retrieves **current permissions** of a file or folder.

### **ðŸ”¹ Syntax**

```powershell
Get-Acl -Path "C:\Path\To\FileOrFolder"
```

### **ðŸ”¹ Example: Get Permissions for a File**

```powershell
Get-Acl -Path "C:\Test\example.txt"
```

âœ… Returns **owner, access control list (ACL), and permissions**.

### **ðŸ”¹ Example: Get Only Access Control Entries**

```powershell
(Get-Acl -Path "C:\Test\example.txt").Access
```

âœ… Extracts **only the list of users and their permissions**.

---

## **ðŸ“Œ 3. Changing File or Folder Owner**

The **owner** of a file or folder has full control over it and can change permissions. To change ownership, you must run PowerShell as **Administrator**.

### **ðŸ”¹ Syntax**

```powershell
$Acl = Get-Acl -Path "C:\Path\To\FileOrFolder"
$Acl.SetOwner([System.Security.Principal.NTAccount]::new("NewOwner"))
Set-Acl -Path "C:\Path\To\FileOrFolder" -AclObject $Acl
```

### **ðŸ”¹ Example: Set Ownership to Another User**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Acl.SetOwner([System.Security.Principal.NTAccount]::new("Administrator"))
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… **Changes the owner** of `example.txt` to `Administrator`.

---

## **ðŸ“Œ 4. Granting Permissions to a User or Group (`Set-Acl`)**

You can **add new permissions** to a file or folder using `Set-Acl`.

### **ðŸ”¹ Syntax**

```powershell
$Acl = Get-Acl -Path "C:\Path\To\FileOrFolder"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("UserOrGroup", "PermissionType", "Allow")
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Path\To\FileOrFolder" -AclObject $Acl
```

### **ðŸ”¹ Example: Grant Full Control to a User**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("JohnDoe", "FullControl", "Allow")
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… Grants **JohnDoe full control** over `example.txt`.

### **ðŸ”¹ Example: Grant Read-Only Access to a User**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("Guest", "Read", "Allow")
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… Allows **Guest to only read** the file.

---

## **ðŸ“Œ 5. Removing a Userâ€™s Permissions (`RemoveAccessRule`)**

If you want to **revoke** a userâ€™s permission, use `RemoveAccessRule`.

### **ðŸ”¹ Syntax**

```powershell
$Acl = Get-Acl -Path "C:\Path\To\FileOrFolder"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("UserOrGroup", "PermissionType", "Allow")
$Acl.RemoveAccessRule($Rule)
Set-Acl -Path "C:\Path\To\FileOrFolder" -AclObject $Acl
```

### **ðŸ”¹ Example: Remove Full Control from a User**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("JohnDoe", "FullControl", "Allow")
$Acl.RemoveAccessRule($Rule)
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… **Revokes JohnDoeâ€™s full control** over `example.txt`.

---

## **ðŸ“Œ 6. Removing All Permissions for a User (`Purge Permissions`)**

To **completely remove a user** from the ACL, use `PurgeAccessRules`.

### **ðŸ”¹ Syntax**

```powershell
$Acl = Get-Acl -Path "C:\Path\To\FileOrFolder"
$Acl.PurgeAccessRules("UserOrGroup")
Set-Acl -Path "C:\Path\To\FileOrFolder" -AclObject $Acl
```

### **ðŸ”¹ Example: Remove All Permissions for a User**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Acl.PurgeAccessRules("JohnDoe")
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… Completely **removes JohnDoeâ€™s access** to the file.

---

## **ðŸ“Œ 7. Setting Inheritance for Folder Permissions (`InheritanceFlags`)**

You can set **permissions to inherit** for all files and subfolders.

### **ðŸ”¹ Syntax**

```powershell
$Acl = Get-Acl -Path "C:\Path\To\Folder"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule(
    "UserOrGroup", "PermissionType", "Allow", "ContainerInherit, ObjectInherit", "None"
)
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Path\To\Folder" -AclObject $Acl
```

### **ðŸ”¹ Example: Apply Read Permission to All Subfolders and Files**

```powershell
$Acl = Get-Acl -Path "C:\Test"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule(
    "Guest", "Read", "Allow", "ContainerInherit, ObjectInherit", "None"
)
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Test" -AclObject $Acl
```

âœ… **Grants read permission** to all files inside `C:\Test`.

---

## **ðŸ“Œ 8. Resetting Permissions to Default (`icacls`)**

If permissions become **corrupt or misconfigured**, reset them.

### **ðŸ”¹ Syntax**

```powershell
icacls "C:\Path\To\FileOrFolder" /reset
```

### **ðŸ”¹ Example: Reset Permissions of a Folder**

```powershell
icacls "C:\Test" /reset
```

âœ… Restores **default permissions**.

---

## **ðŸ“Œ 9. Granting Full Control to Everyone (Use with Caution)**

Giving **"Everyone"** full control is risky, as it allows **any user** to modify or delete the file.

### **ðŸ”¹ Example: Grant Full Control to Everyone**

```powershell
$Acl = Get-Acl -Path "C:\Test\example.txt"
$Rule = New-Object System.Security.AccessControl.FileSystemAccessRule("Everyone", "FullControl", "Allow")
$Acl.SetAccessRule($Rule)
Set-Acl -Path "C:\Test\example.txt" -AclObject $Acl
```

âœ… **Allows all users** to access and modify the file.

---

## **ðŸŽ¯ Conclusion: Mastering File Permissions in PowerShell**

âœ… Use `Get-Acl` to **view permissions**  
âœ… Use `Set-Acl` to **grant or revoke access**  
âœ… Remove a user's permission with `RemoveAccessRule`  
âœ… **Purge all permissions** for a user with `PurgeAccessRules`  
âœ… Reset permissions to default with `icacls /reset`

Would you like **automation scripts for file permission management?** Let me know! ðŸ˜ŠðŸš€
