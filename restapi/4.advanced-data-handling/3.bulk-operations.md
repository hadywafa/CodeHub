# ğŸ“¦ Bulk Operations (Batch Endpoints)

## ğŸ§© Why Bulk Operations?

Imagine you need to:

- Create 100 users
- Delete 50 products
- Update 30 orders

Without bulk: â†’ 180 separate API calls ğŸ˜±

- More network overhead
- Slower
- Harder to guarantee consistency

ğŸ‘‰ Bulk operations = handle **many items in one request**.

---

## 1ï¸âƒ£ Common Approaches

### ğŸ”¹ Batch Endpoint

- A dedicated endpoint (like `/batch` or `/bulk`) that accepts **multiple operations**.

Example:

```http
POST /users/batch
```

Request body:

```json
[
  { "name": "Ali", "email": "ali@test.com" },
  { "name": "Sara", "email": "sara@test.com" }
]
```

Response:

```json
[
  { "id": 1, "name": "Ali", "email": "ali@test.com" },
  { "id": 2, "name": "Sara", "email": "sara@test.com" }
]
```

---

### ğŸ”¹ Mixed Operation Batch

Some APIs allow **different actions in one call**.

```http
POST /batch
```

Request body:

```json
{
  "operations": [
    { "method": "POST", "path": "/users", "body": { "name": "Ali" } },
    { "method": "DELETE", "path": "/orders/123" },
    { "method": "PUT", "path": "/products/42", "body": { "price": 99.99 } }
  ]
}
```

Response:

```json
{
  "results": [
    { "status": 201, "body": { "id": 1, "name": "Ali" } },
    { "status": 204 },
    { "status": 200, "body": { "id": 42, "price": 99.99 } }
  ]
}
```

ğŸ‘‰ Google APIs and Facebook Graph API support this style.

---

### ğŸ”¹ Bulk Delete/Update with Filters

Instead of sending IDs one by one:

```http
DELETE /orders?status=cancelled
```

ğŸ‘‰ Deletes **all cancelled orders** in one go.

---

## 2ï¸âƒ£ Example: Bulk Order Creation

```http
POST /orders/batch
```

Request:

```json
{
  "orders": [
    { "customer": "Ali", "items": [1, 2, 3] },
    { "customer": "Sara", "items": [4, 5] }
  ]
}
```

Response:

```json
{
  "results": [
    { "id": 101, "customer": "Ali", "status": "CREATED" },
    { "id": 102, "customer": "Sara", "status": "CREATED" }
  ]
}
```

---

## 3ï¸âƒ£ Error Handling in Bulk

Bulk APIs need **per-item results**.

```json
{
  "results": [
    { "id": 101, "status": "CREATED" },
    { "error": "Invalid item ID 999", "status": 400 }
  ]
}
```

ğŸ‘‰ This way, one bad item doesnâ€™t kill the whole batch.

---

## ğŸ–¼ï¸ Flow Diagram

<div align="center">

```mermaid
sequenceDiagram
    participant Client
    participant API
    Client->>API: POST /users/batch { [user1, user2, user3] }
    API->>API: Process each user
    API-->>Client: 201 Created { results: [ok, ok, error] }
```

</div>

---

## âš¡ Best Practices

- âœ… Support **per-item results** (donâ€™t fail all if one fails).
- âœ… Document **max batch size** (to avoid server overload).
- âœ… Return **detailed errors** per item.
- âœ… Consider **async bulk jobs** (for very large datasets).
- âœ… Use bulk endpoints for **create/update/delete**, but keep them predictable.

---

## âœ… Recap

- Bulk operations = fewer requests, faster APIs.
- Styles: simple bulk (`/batch`), mixed ops, bulk filters.
- Must return **per-item results**.
- Watch out for batch size limits + async jobs for heavy lifting.

> ğŸ’¡ Bulk APIs = like ordering **a combo meal** instead of 10 separate burgers ğŸ”ğŸŸğŸ¥¤.
