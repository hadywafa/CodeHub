# âš¡ HTTP Methods & Idempotency

## ğŸ“Œ Common HTTP Methods in REST

| Method     | Typical Use                    | Example            | Notes                                   |
| ---------- | ------------------------------ | ------------------ | --------------------------------------- |
| **GET**    | Read data                      | `GET /users/42`    | Safe, no side effects                   |
| **POST**   | Create new resource            | `POST /users`      | Not idempotent (creates new every time) |
| **PUT**    | Replace resource (full update) | `PUT /users/42`    | Idempotent                              |
| **PATCH**  | Partial update                 | `PATCH /users/42`  | Not guaranteed idempotent               |
| **DELETE** | Remove resource                | `DELETE /users/42` | Idempotent                              |

---

## ğŸ§  Idempotency Explained

**Idempotent =** doing the same operation **multiple times** gives the **same result**.

- Like turning a light switch **off twice** â†’ light is still off.
- Not idempotent = pressing â€œadd 1 coinâ€ multiple times keeps adding coins.

---

## ğŸ” Method by Method

### 1ï¸âƒ£ GET

- **Usage**: fetch resources.
- **Idempotent?** âœ… Yes.
- **Safe?** âœ… Yes (doesnâ€™t change server state).

Example:

```http
GET /users/42
```

No matter how many times â†’ same result (unless data changes elsewhere).

---

### 2ï¸âƒ£ POST

- **Usage**: create new resource.
- **Idempotent?** âŒ No.
- **Safe?** âŒ No (changes server state).

Example:

```http
POST /orders
{
  "item": "Laptop"
}
```

- Call once â†’ order #101 created.
- Call again â†’ order #102 created.

ğŸ‘‰ Each call creates **new resource** â†’ not idempotent.

---

### 3ï¸âƒ£ PUT

- **Usage**: replace resource completely.
- **Idempotent?** âœ… Yes.
- **Safe?** âŒ No.

Example:

```http
PUT /users/42
{
  "id": 42,
  "name": "Ali",
  "email": "ali@example.com"
}
```

- First call â†’ user updated.
- Call again with same body â†’ nothing changes.
- Same result â†’ **idempotent**.

---

### 4ï¸âƒ£ PATCH

- **Usage**: update part of resource.
- **Idempotent?** ğŸ¤· Sometimes.
- **Safe?** âŒ No.

Example:

```http
PATCH /users/42
{
  "loginCount": 5
}
```

If PATCH means â€œset loginCount = 5â€ â†’ idempotent.
If PATCH means â€œincrement loginCount by 5â€ â†’ not idempotent.

---

### 5ï¸âƒ£ DELETE

- **Usage**: remove resource.
- **Idempotent?** âœ… Yes.
- **Safe?** âŒ No.

Example:

```http
DELETE /users/42
```

- First call â†’ user gone.
- Second call â†’ user still gone (maybe 404, but state = same).

---

## ğŸ–¼ï¸ Visual Summary

<div align="center">

```mermaid
flowchart LR
    A[GET] -->|Safe & Idempotent| B[(Read only)]
    C[POST] -->|Not Idempotent| D[(Creates new each call)]
    E[PUT] -->|Idempotent| F[(Replaces resource)]
    G[PATCH] -->|Sometimes| H[(Partial update)]
    I[DELETE] -->|Idempotent| J[(Removes resource)]
```

</div>

---

## âš¡ Pro Tips

- âœ… Use **POST** only for create (donâ€™t overload it for updates).
- âœ… Use **PUT** for full replace, **PATCH** for partial updates.
- âœ… GET requests should never change server state (even logs/metrics should be careful).
- âœ… DELETE should return `204 No Content` when successful.
- âœ… Idempotency is crucial for **retries** (e.g., when a request is retried after timeout).

---

## âœ… Recap

- **GET** = safe + idempotent.
- **POST** = not idempotent.
- **PUT** = idempotent (full replace).
- **PATCH** = maybe idempotent (depends on semantics).
- **DELETE** = idempotent.

> ğŸ’¡ Rule of thumb: â€œIdempotent methods can be retried without fear. Non-idempotent ones (like POST) need extra care.â€
