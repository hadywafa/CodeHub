# ğŸ“¦ Content Negotiation (JSON, XML, etc.)

## ğŸ§© What is Content Negotiation?

Content Negotiation = a **conversation between client and server** to decide **in which format** the data should be exchanged.

ğŸ‘‰ Example:

- Some clients love **JSON** (modern web apps).
- Some legacy clients need **XML**.
- Some systems want **CSV/Excel**.

Instead of building multiple APIs, we make **one API** that supports multiple formats.

---

## ğŸ”‘ How Does It Work?

The magic happens in HTTP **headers**:

### 1ï¸âƒ£ `Accept` header (client â†’ server)

Client says what it wants:

```http
GET /users/42
Accept: application/json
```

or

```http
Accept: application/xml
```

### 2ï¸âƒ£ `Content-Type` header (server â†’ client)

Server replies with what itâ€™s giving:

```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 42,
  "name": "Ali"
}
```

---

## ğŸ§‘â€ğŸ’» Example in Action

### Request JSON

```http
GET /users/42
Accept: application/json
```

Response:

```json
{
  "id": 42,
  "name": "Ali"
}
```

### Request XML

```http
GET /users/42
Accept: application/xml
```

Response:

```xml
<User>
  <Id>42</Id>
  <Name>Ali</Name>
</User>
```

---

## ğŸ–¼ï¸ Visual Flow

```mermaid
sequenceDiagram
    participant Client
    participant Server
    Client->>Server: GET /users/42 <br> Accept: application/json
    Server->>Server: Serialize user into JSON
    Server-->>Client: 200 OK <br> Content-Type: application/json <br> { "id": 42, "name": "Ali" }
```

---

## ğŸ“Œ When to Use

- **JSON** â†’ default for modern REST APIs (lightweight, widely supported).
- **XML** â†’ legacy systems, SOAP replacements.
- **CSV/Excel** â†’ data export/reporting.
- **HTML** â†’ if API doubles as a web page (rare in pure APIs).

---

## âš¡ Pro Tips

- âœ… Always default to **JSON** unless client asks otherwise.
- âœ… Be explicit: use `Content-Type` in both request & response.
- âœ… Support only formats you can realistically maintain (donâ€™t promise XML if nobody tests it).
- âœ… Donâ€™t auto-switch based on query params (`/users?format=xml`) unless needed for browsers.
- âœ… Avoid sending multiple formats in one response (confuses clients).

---

## âœ… Recap

- **Content Negotiation** = client says â€œI want JSON/XML,â€ server replies accordingly.
- Uses **Accept** (client) and **Content-Type** (server) headers.
- JSON is the standard default, but APIs can support XML, CSV, HTML, etc.
- Keep it **consistent, predictable, and minimal**.

> ğŸ’¡ A REST API should feel like a multilingual waiter: it gives you the same dish (data) in the language (format) you prefer.
