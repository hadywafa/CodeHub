# **ðŸš€ Managing Users and Groups in PowerShell - A Complete Guide**

PowerShell provides powerful cmdlets to **manage local users, Active Directory users, and groups**. Whether you're an IT administrator managing user accounts or a DevOps engineer automating identity management, **PowerShell simplifies the process**.

---

## **ðŸ“Œ 1. Managing Local Users & Groups in PowerShell**

### **ðŸ”¹ Checking If PowerShell Can Manage Local Users**

Before using PowerShell to manage users, ensure the **LocalAccounts** module is available:

```powershell
Get-Module -ListAvailable -Name Microsoft.PowerShell.LocalAccounts
```

âœ… If not available, ensure you're **running PowerShell as Administrator**.

---

## **ðŸ“Œ 2. Working with Local Users**

### **ðŸ”¹ Get Local Users**

```powershell
Get-LocalUser
```

âœ… Retrieves **all local user accounts** on the system.

### **ðŸ”¹ Get Details of a Specific User**

```powershell
Get-LocalUser -Name "Administrator"
```

âœ… Retrieves **details** of a specific user.

---

### **ðŸ”¹ Creating a New Local User**

```powershell
$Password = ConvertTo-SecureString "P@ssword123" -AsPlainText -Force
New-LocalUser -Name "JohnDoe" -Password $Password -FullName "John Doe" -Description "IT Administrator"
```

âœ… Creates a user **JohnDoe** with a **secure password**.

---

### **ðŸ”¹ Modifying an Existing User**

```powershell
Set-LocalUser -Name "JohnDoe" -Password (ConvertTo-SecureString "NewP@ssword" -AsPlainText -Force)
```

âœ… **Changes the password** of an existing user.

---

### **ðŸ”¹ Enable or Disable a User Account**

```powershell
Disable-LocalUser -Name "JohnDoe"  # Disables the user
Enable-LocalUser -Name "JohnDoe"   # Enables the user
```

âœ… **Disable or enable** a local user account.

---

### **ðŸ”¹ Remove a Local User**

```powershell
Remove-LocalUser -Name "JohnDoe"
```

âœ… **Deletes the user account** from the system.

---

## **ðŸ“Œ 3. Managing Local Groups**

### **ðŸ”¹ Get Local Groups**

```powershell
Get-LocalGroup
```

âœ… Lists **all local groups**.

### **ðŸ”¹ Get Members of a Specific Group**

```powershell
Get-LocalGroupMember -Group "Administrators"
```

âœ… Shows **who is in the Administrators group**.

---

### **ðŸ”¹ Create a New Local Group**

```powershell
New-LocalGroup -Name "Developers" -Description "Developer Group"
```

âœ… Creates a group called **Developers**.

---

### **ðŸ”¹ Add a User to a Group**

```powershell
Add-LocalGroupMember -Group "Administrators" -Member "JohnDoe"
```

âœ… Adds **JohnDoe** to the **Administrators group**.

---

### **ðŸ”¹ Remove a User from a Group**

```powershell
Remove-LocalGroupMember -Group "Administrators" -Member "JohnDoe"
```

âœ… Removes **JohnDoe** from the **Administrators group**.

---

### **ðŸ”¹ Delete a Local Group**

```powershell
Remove-LocalGroup -Name "Developers"
```

âœ… Deletes the **Developers** group.

---

## **ðŸ“Œ 4. Managing Active Directory (AD) Users & Groups**

PowerShell allows **managing Active Directory (AD) users and groups** using the **Active Directory module**.

### **ðŸ”¹ Import the Active Directory Module**

```powershell
Import-Module ActiveDirectory
```

âœ… Loads **AD management commands**.

---

### **ðŸ”¹ Get Active Directory Users**

```powershell
Get-ADUser -Filter * -Property DisplayName,SamAccountName
```

âœ… Lists **all users** with **DisplayName and Username**.

---

### **ðŸ”¹ Get a Specific User by Username**

```powershell
Get-ADUser -Identity "jdoe" -Properties *
```

âœ… Displays **all properties** for user **jdoe**.

---

### **ðŸ”¹ Create a New AD User**

```powershell
New-ADUser -Name "John Doe" -GivenName "John" -Surname "Doe" -SamAccountName "jdoe" -UserPrincipalName "jdoe@company.com" -Path "OU=Users,DC=company,DC=com" -AccountPassword (ConvertTo-SecureString "P@ssword123" -AsPlainText -Force) -Enabled $true
```

âœ… Creates **John Doe** in Active Directory.

---

### **ðŸ”¹ Set a Userâ€™s Password**

```powershell
Set-ADAccountPassword -Identity "jdoe" -NewPassword (ConvertTo-SecureString "NewP@ssword" -AsPlainText -Force)
```

âœ… Updates **jdoe's password**.

---

### **ðŸ”¹ Enable or Disable an AD User**

```powershell
Disable-ADAccount -Identity "jdoe"  # Disables the account
Enable-ADAccount -Identity "jdoe"   # Enables the account
```

âœ… **Disable or enable** an AD user.

---

### **ðŸ”¹ Move a User to a Different Organizational Unit (OU)**

```powershell
Move-ADObject -Identity "CN=John Doe,OU=Users,DC=company,DC=com" -TargetPath "OU=IT,DC=company,DC=com"
```

âœ… Moves **John Doe to the IT department**.

---

### **ðŸ”¹ Delete an AD User**

```powershell
Remove-ADUser -Identity "jdoe" -Confirm:$false
```

âœ… Deletes **jdoe** without confirmation.

---

## **ðŸ“Œ 5. Managing Active Directory Groups**

### **ðŸ”¹ Get All AD Groups**

```powershell
Get-ADGroup -Filter *
```

âœ… Lists **all AD groups**.

---

### **ðŸ”¹ Get Members of a Group**

```powershell
Get-ADGroupMember -Identity "Administrators"
```

âœ… Lists **all users in the Administrators group**.

---

### **ðŸ”¹ Create a New AD Group**

```powershell
New-ADGroup -Name "Developers" -GroupScope Global -Path "OU=Groups,DC=company,DC=com"
```

âœ… Creates a **Developers** group.

---

### **ðŸ”¹ Add a User to a Group**

```powershell
Add-ADGroupMember -Identity "Developers" -Members "jdoe"
```

âœ… Adds **jdoe** to the **Developers** group.

---

### **ðŸ”¹ Remove a User from a Group**

```powershell
Remove-ADGroupMember -Identity "Developers" -Members "jdoe" -Confirm:$false
```

âœ… Removes **jdoe** from the **Developers** group.

---

### **ðŸ”¹ Delete an AD Group**

```powershell
Remove-ADGroup -Identity "Developers" -Confirm:$false
```

âœ… Deletes the **Developers** group.

---

## **ðŸ“Œ 6. Finding & Auditing Users and Groups**

### **ðŸ”¹ Find Disabled Accounts**

```powershell
Get-ADUser -Filter {Enabled -eq $false} -Properties DisplayName
```

âœ… Lists **all disabled accounts**.

---

### **ðŸ”¹ Find Users Not Logged In for 30 Days**

```powershell
$Date = (Get-Date).AddDays(-30)
Get-ADUser -Filter {LastLogonTimeStamp -lt $Date} -Properties LastLogonTimeStamp
```

âœ… Finds **inactive users**.

---

### **ðŸ”¹ Find All Users in a Specific OU**

```powershell
Get-ADUser -SearchBase "OU=IT,DC=company,DC=com" -Filter *
```

âœ… Lists **all users in the IT department**.

---

## **ðŸ“Œ 7. Best Practices for User & Group Management in PowerShell**

âœ… **Use Secure Passwords** â†’ Always use `ConvertTo-SecureString` for passwords.  
âœ… **Restrict Access** â†’ Use **groups** instead of assigning permissions directly.  
âœ… **Audit Regularly** â†’ Run **user and group reports** to ensure security.  
âœ… **Document Changes** â†’ Log **user creations, deletions, and modifications**.  
âœ… **Automate User Management** â†’ Use PowerShell scripts **for onboarding and offboarding**.

---

## **ðŸŽ¯ Conclusion: Mastering User & Group Management in PowerShell**

âœ… **Manage local users & groups** with `Get-LocalUser`, `New-LocalUser`, `Get-LocalGroupMember`.  
âœ… **Control Active Directory users & groups** using `Get-ADUser`, `New-ADUser`, `Add-ADGroupMember`.  
âœ… **Audit users & groups** with `Get-ADUser`, `Get-ADGroupMember`, and `LastLogonTimeStamp`.  
âœ… **Follow best security practices** to keep user accounts **secure and organized**.
