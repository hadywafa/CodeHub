# **ğŸš€ PowerShell Pipelines - A Complete Guide**

PowerShell **pipelines (`|`)** allow commands to **pass data from one command to another**. This enables **efficient data processing, filtering, and transformation**.

---

## **ğŸ“Œ 1. What is a Pipeline in PowerShell?**

A **pipeline** (`|`) is used to **send output from one command (cmdlet) as input to another command**.

### **ğŸ”¹ Why Use Pipelines?**

âœ… Reduces code complexity  
âœ… Improves performance by processing data in chunks  
âœ… Automates filtering and transformation of objects  
âœ… Makes scripts more readable

### **ğŸ”¹ Basic Pipeline Example**

```powershell
Get-Process | Sort-Object CPU
```

âœ… `Get-Process` retrieves running processes, and `Sort-Object` sorts them by CPU usage.

---

## **ğŸ“Œ 2. How the Pipeline Works in PowerShell**

PowerShell **passes objects** (not just text) between pipeline stages.

### **ğŸ”¹ Example: Passing Objects**

```powershell
Get-Service | Where-Object {$_.Status -eq "Running"}
```

âœ… `Get-Service` retrieves services, and `Where-Object` filters only running ones.

---

## **ğŸ“Œ 3. Understanding Object Types in Pipelines**

Since PowerShell **passes objects** (not plain text), you can inspect the output **before passing it**.

### **ğŸ”¹ Example: Inspect Object Properties**

```powershell
Get-Process | Get-Member
```

âœ… This **displays available properties and methods** of the process object.

### **ğŸ”¹ Example: Selecting Specific Properties**

```powershell
Get-Process | Select-Object Name, CPU
```

âœ… Extracts only `Name` and `CPU` from the process list.

---

## **ğŸ“Œ 4. Using `Where-Object` to Filter Data in Pipelines**

`Where-Object` is used to **filter objects** in the pipeline.

### **ğŸ”¹ Syntax**

```powershell
Where-Object { $_.Property -Operator Value }
```

âœ… `$_` represents the **current object** in the pipeline.

### **ğŸ”¹ Example: Get High-CPU Processes**

```powershell
Get-Process | Where-Object {$_.CPU -gt 100}
```

âœ… Filters processes using **more than 100 CPU time**.

### **ğŸ”¹ Example: Find Stopped Services**

```powershell
Get-Service | Where-Object {$_.Status -eq "Stopped"}
```

âœ… Lists only **stopped services**.

---

## **ğŸ“Œ 5. Using `ForEach-Object` to Modify Pipeline Data**

`ForEach-Object` **processes each item in the pipeline**.

### **ğŸ”¹ Example: Get Process Names**

```powershell
Get-Process | ForEach-Object { $_.Name }
```

âœ… Extracts **only the process names**.

### **ğŸ”¹ Example: Stop Specific Processes**

```powershell
Get-Process | Where-Object {$_.CPU -gt 100} | ForEach-Object { Stop-Process -Id $_.Id }
```

âœ… **Stops all high-CPU processes**.

---

## **ğŸ“Œ 6. Sorting and Grouping Pipeline Data**

### **ğŸ”¹ Sorting with `Sort-Object`**

```powershell
Get-Process | Sort-Object -Property CPU -Descending
```

âœ… Sorts processes **by CPU usage** in **descending order**.

### **ğŸ”¹ Grouping with `Group-Object`**

```powershell
Get-Process | Group-Object -Property ProcessName
```

âœ… Groups processes **by name**.

---

## **ğŸ“Œ 7. Limiting Results in Pipelines**

### **ğŸ”¹ `Select-Object` to Limit Output**

```powershell
Get-Process | Select-Object -First 5
```

âœ… Shows **only the first 5 processes**.

```powershell
Get-Process | Select-Object -Last 3
```

âœ… Shows **only the last 3 processes**.

---

## **ğŸ“Œ 8. Formatting Output in Pipelines**

### **ğŸ”¹ Table Format (`Format-Table`)**

```powershell
Get-Process | Format-Table -AutoSize
```

âœ… Formats output as a **table**.

### **ğŸ”¹ List Format (`Format-List`)**

```powershell
Get-Process | Format-List
```

âœ… Formats output as a **list**.

---

## **ğŸ“Œ 9. Exporting Pipeline Data**

### **ğŸ”¹ Exporting to a CSV File**

```powershell
Get-Process | Select-Object Name, CPU | Export-Csv -Path "C:\processes.csv" -NoTypeInformation
```

âœ… Saves process data to **CSV format**.

### **ğŸ”¹ Exporting to JSON**

```powershell
Get-Process | Select-Object Name, CPU | ConvertTo-Json
```

âœ… Converts output to **JSON format**.

---

## **ğŸ“Œ 10. Passing Data Between Scripts with Pipelines**

Pipelines can **pass data between scripts** dynamically.

### **ğŸ”¹ Example: Pass Data to Another Script**

```powershell
Get-Process | .\ProcessAnalyzer.ps1
```

âœ… Passes process data to the script `ProcessAnalyzer.ps1`.

---

## **ğŸ“Œ 11. Best Practices for Using Pipelines**

âœ… **Use Pipelines for Large Datasets** â†’ PowerShell **processes one object at a time**, optimizing performance.  
âœ… **Use `Select-Object` Early** â†’ Limit data **before passing it further** in the pipeline.  
âœ… **Use `Where-Object` for Filtering** â†’ Filter data **before heavy operations** like sorting.  
âœ… **Avoid Unnecessary Loops** â†’ Use `ForEach-Object` **instead of loops** for inline processing.  
âœ… **Use `Measure-Object` to Summarize Data** â†’ Quickly count, sum, or average values.

---

## **ğŸ“Œ 12. Combining Multiple Pipeline Commands**

### **ğŸ”¹ Example: Get and Format Top 5 CPU-Consuming Processes**

```powershell
Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 | Format-Table -AutoSize
```

âœ… Gets the **top 5 CPU-consuming processes** and **formats them as a table**.

---

## **ğŸ¯ Conclusion: Mastering PowerShell Pipelines**

âœ… **Pipelines (`|`) pass data** between commands for **efficient processing**.  
âœ… Use **`Where-Object` for filtering** and **`ForEach-Object` for transformations**.  
âœ… **Sort, format, and export data** with `Sort-Object`, `Format-Table`, and `Export-Csv`.  
âœ… **Follow best practices** to **optimize script performance**.

### **ğŸš€ Next Steps:**

âœ”ï¸ **Practice filtering and sorting data using pipelines.**  
âœ”ï¸ **Use pipelines to pass objects to functions and scripts.**  
âœ”ï¸ **Experiment with exporting pipeline data in different formats.**

Would you like **real-world pipeline automation examples**? Let me know! ğŸ˜ŠğŸš€
