# **ğŸš€ PowerShell Scripting & Automation - A Complete Guide**

PowerShell scripting and automation help streamline **repetitive tasks**, improve **efficiency**, and enable **task scheduling**. This guide covers everything from **writing reusable scripts** to **automating tasks with Task Scheduler and Cron Jobs**.

---

## **ğŸ“Œ 1. Writing Reusable Scripts (.ps1 files)**

A **PowerShell script** is a file with a `.ps1` extension containing **PowerShell commands** and **logic** that automate tasks.

### **ğŸ”¹ Creating a PowerShell Script**

1ï¸âƒ£ Open **Notepad** or **PowerShell ISE**  
2ï¸âƒ£ Write the PowerShell commands  
3ï¸âƒ£ Save the file with a **`.ps1`** extension

### **ğŸ”¹ Example: Simple Script**

```powershell
# Save this as MyScript.ps1
Write-Output "Hello, PowerShell!"
```

### **ğŸ”¹ Running a PowerShell Script**

To execute a script:

```powershell
.\MyScript.ps1
```

âœ… Runs the script from the **current directory**.

### **ğŸ”¹ Allow Execution of Scripts**

By default, PowerShell restricts running scripts for security. To allow:

```powershell
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser
```

âœ… Enables **script execution** for the current user.

---

## **ğŸ“Œ 2. Parameterized Scripts**

Scripts can accept **parameters** to make them **dynamic and reusable**.

### **ğŸ”¹ Defining Parameters in a Script**

```powershell
param (
    [string]$Name,
    [int]$Age
)

Write-Output "Hello, $Name! You are $Age years old."
```

âœ… Saves this as **`GreetUser.ps1`**.

### **ğŸ”¹ Running the Script with Parameters**

```powershell
.\GreetUser.ps1 -Name "John" -Age 30
```

âœ… Outputs:

```ini
Hello, John! You are 30 years old.
```

### **ğŸ”¹ Using Default Parameter Values**

```powershell
param (
    [string]$User = "Guest"
)

Write-Output "Welcome, $User!"
```

âœ… If no parameter is passed, it **defaults to "Guest"**.

---

## **ğŸ“Œ 3. Scheduled Tasks & Job Automation**

### **ğŸ”¹ Running PowerShell Scripts in the Background**

You can **run scripts in the background** using **jobs**.

#### **Start a Background Job**

```powershell
Start-Job -ScriptBlock { Get-Process | Out-File C:\Logs\processlist.txt }
```

âœ… Runs the command **in the background**.

#### **List Running Jobs**

```powershell
Get-Job
```

#### **Get Job Output**

```powershell
Receive-Job -Id <JobId>
```

#### **Stop a Job**

```powershell
Stop-Job -Id <JobId>
```

---

## **ğŸ“Œ 4. Logging & Monitoring with PowerShell**

### **ğŸ”¹ Writing Logs to a File**

#### **Example: Log System Uptime**

```powershell
$logPath = "C:\Logs\SystemUptime.log"
$timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
$uptime = (Get-CimInstance Win32_OperatingSystem).LastBootUpTime

"$timestamp - System Uptime: $uptime" | Out-File -Append -FilePath $logPath
```

âœ… **Logs system uptime with a timestamp**.

---

### **ğŸ”¹ Creating an Event Log Entry**

PowerShell can write **custom logs** to the **Windows Event Viewer**.

#### **Example: Write to Event Log**

```powershell
Write-EventLog -LogName Application -Source "MyScript" -EntryType Information -EventId 1001 -Message "PowerShell script executed successfully."
```

âœ… Logs a **custom event** in Windows **Event Viewer**.

---

## **ğŸ“Œ 5. Using PowerShell with Task Scheduler & Cron Jobs**

### **ğŸ”¹ Schedule a PowerShell Script Using Task Scheduler**

1ï¸âƒ£ **Open Task Scheduler** (`taskschd.msc`)  
2ï¸âƒ£ Click **"Create Basic Task"**  
3ï¸âƒ£ **Set a trigger** (daily, weekly, at startup, etc.)  
4ï¸âƒ£ **Set an action** â†’ Choose **"Start a Program"**  
5ï¸âƒ£ Enter **PowerShell.exe** as the program  
6ï¸âƒ£ Add script path in **arguments**:

```powershell
-ExecutionPolicy Bypass -File "C:\Scripts\MyScript.ps1"
```

âœ… The script will run **automatically on schedule**.

---

### **ğŸ”¹ Using PowerShell with Cron Jobs (Linux/macOS)**

On Linux/macOS, you can **schedule PowerShell scripts** using `cron`.

#### **Example: Schedule a Script to Run Every Hour**

1ï¸âƒ£ Open the crontab editor:

```bash
crontab -e
```

2ï¸âƒ£ Add the cron job:

```bash
0 * * * * pwsh /home/user/myscript.ps1
```

âœ… Runs **`myscript.ps1` every hour**.

---

## **ğŸ“Œ 6. Real-World Automation Examples**

### **ğŸ”¹ Automating System Cleanup**

```powershell
# Delete files older than 30 days
$path = "C:\Temp"
$days = 30
Get-ChildItem -Path $path -Recurse | Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-$days) } | Remove-Item -Force
```

âœ… Removes **files older than 30 days**.

---

### **ğŸ”¹ Automatically Backup Files**

```powershell
$source = "C:\Users\John\Documents"
$destination = "D:\Backup\Documents_$(Get-Date -Format 'yyyyMMddHHmmss')"
Copy-Item -Path $source -Destination $destination -Recurse
```

âœ… Creates **a timestamped backup** of the Documents folder.

---

### **ğŸ”¹ Send an Email Notification**

```powershell
$SMTPServer = "smtp.example.com"
$From = "alerts@example.com"
$To = "admin@example.com"
$Subject = "PowerShell Script Alert"
$Body = "Your PowerShell script has completed execution."

Send-MailMessage -To $To -From $From -Subject $Subject -Body $Body -SmtpServer $SMTPServer
```

âœ… **Sends an email alert** when a script completes.

---

### **ğŸ”¹ Monitor CPU Usage and Alert**

```powershell
$cpuUsage = (Get-Counter "\Processor(_Total)\% Processor Time").CounterSamples.CookedValue
if ($cpuUsage -gt 80) {
    Write-Output "High CPU Usage: $cpuUsage%"
    Send-MailMessage -To "admin@example.com" -From "alerts@example.com" -Subject "High CPU Alert" -Body "CPU usage is above 80% ($cpuUsage%)" -SmtpServer "smtp.example.com"
}
```

âœ… **Sends an alert if CPU usage exceeds 80%**.

---

## **ğŸ“Œ 7. Best Practices for PowerShell Scripting & Automation**

âœ… **Use Parameterized Scripts** â†’ Make scripts reusable and flexible.  
âœ… **Use Logging** â†’ Save logs for troubleshooting and monitoring.  
âœ… **Secure Sensitive Information** â†’ Use `ConvertTo-SecureString` for passwords.  
âœ… **Schedule Scripts** â†’ Automate repetitive tasks using **Task Scheduler or cron jobs**.  
âœ… **Monitor System Performance** â†’ Automate performance checks and alerts.

---

## **ğŸ¯ Conclusion: Mastering PowerShell Scripting & Automation**

âœ… **Write and execute reusable scripts** (`.ps1` files)  
âœ… **Use parameters to make scripts dynamic**  
âœ… **Schedule tasks and automate processes**  
âœ… **Log script execution and monitor systems**  
âœ… **Integrate PowerShell with Task Scheduler and cron jobs**

Would you like **real-world PowerShell automation scripts?** Let me know! ğŸ˜ŠğŸš€
